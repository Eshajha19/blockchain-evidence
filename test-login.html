<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Test - EVID-DGC</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .btn {
            background: #D32F2F;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #B71C1C;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { background: #e8f5e8; color: #2e7d32; }
        .error { background: #ffebee; color: #c62828; }
        .info { background: #e3f2fd; color: #1976d2; }
    </style>
</head>
<body>
    <h1>EVID-DGC Login Test</h1>
    
    <div class="test-section">
        <h2>Test Email Login</h2>
        <p>Test the email login functionality with these credentials:</p>
        <ul>
            <li><strong>Admin:</strong> gc67766@gmail.com / @Gopichand1@</li>
            <li><strong>Test User:</strong> test@example.com / password123</li>
        </ul>
        
        <form id="testLoginForm">
            <div>
                <label>Email:</label><br>
                <input type="email" id="testEmail" value="gc67766@gmail.com" style="width: 100%; padding: 8px; margin: 5px 0;">
            </div>
            <div>
                <label>Password:</label><br>
                <input type="password" id="testPassword" value="@Gopichand1@" style="width: 100%; padding: 8px; margin: 5px 0;">
            </div>
            <button type="submit" class="btn">Test Login</button>
        </form>
        
        <div id="loginResult"></div>
    </div>
    
    <div class="test-section">
        <h2>Test Wallet Connection</h2>
        <button onclick="testWalletConnection()" class="btn">Test Wallet Connection</button>
        <div id="walletResult"></div>
    </div>
    
    <div class="test-section">
        <h2>Test Registration</h2>
        <button onclick="testRegistration()" class="btn">Test Registration</button>
        <div id="registrationResult"></div>
    </div>
    
    <div class="test-section">
        <h2>Storage Test</h2>
        <button onclick="testStorage()" class="btn">Test LocalStorage</button>
        <div id="storageResult"></div>
    </div>

    <script>
        // Test email login
        document.getElementById('testLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const email = document.getElementById('testEmail').value;
            const password = document.getElementById('testPassword').value;
            const resultDiv = document.getElementById('loginResult');
            
            // Admin login check
            if (email.toLowerCase() === 'gc67766@gmail.com' && password === '@Gopichand1@') {
                const adminData = {
                    email: 'gc67766@gmail.com',
                    fullName: 'System Administrator',
                    role: 8,
                    department: 'Administration',
                    isRegistered: true,
                    walletAddress: '0x29bb7718d5c6da6e787deae8fd6bb3459e8539f2',
                    loginType: 'email',
                    accountType: 'admin'
                };
                
                localStorage.setItem('emailUser_' + email, JSON.stringify(adminData));
                localStorage.setItem('currentUser', 'email_' + email);
                
                resultDiv.innerHTML = '<div class="status success">✅ Admin login successful!</div>';
                return;
            }
            
            // Check for existing user
            const savedUser = localStorage.getItem('emailUser_' + email);
            if (savedUser) {
                const userData = JSON.parse(savedUser);
                if (userData.password === password) {
                    localStorage.setItem('currentUser', 'email_' + email);
                    resultDiv.innerHTML = '<div class="status success">✅ Login successful!</div>';
                } else {
                    resultDiv.innerHTML = '<div class="status error">❌ Invalid password</div>';
                }
            } else {
                resultDiv.innerHTML = '<div class="status error">❌ User not found</div>';
            }
        });
        
        // Test wallet connection
        function testWalletConnection() {
            const resultDiv = document.getElementById('walletResult');
            
            if (typeof window.ethereum !== 'undefined') {
                resultDiv.innerHTML = '<div class="status success">✅ MetaMask detected</div>';
            } else {
                resultDiv.innerHTML = '<div class="status info">ℹ️ MetaMask not detected - Demo mode available</div>';
            }
        }
        
        // Test registration
        function testRegistration() {
            const resultDiv = document.getElementById('registrationResult');
            
            const testUser = {
                email: 'test@example.com',
                password: 'password123',
                fullName: 'Test User',
                role: 2,
                department: 'Testing',
                isRegistered: true,
                registrationDate: new Date().toISOString(),
                loginType: 'email'
            };
            
            localStorage.setItem('emailUser_test@example.com', JSON.stringify(testUser));
            resultDiv.innerHTML = '<div class="status success">✅ Test user created successfully</div>';
        }
        
        // Test storage
        function testStorage() {
            const resultDiv = document.getElementById('storageResult');
            
            try {
                localStorage.setItem('test', 'working');
                const test = localStorage.getItem('test');
                localStorage.removeItem('test');
                
                if (test === 'working') {
                    resultDiv.innerHTML = '<div class="status success">✅ LocalStorage working correctly</div>';
                } else {
                    resultDiv.innerHTML = '<div class="status error">❌ LocalStorage not working</div>';
                }
            } catch (error) {
                resultDiv.innerHTML = '<div class="status error">❌ LocalStorage error: ' + error.message + '</div>';
            }
        }
        
        // Show current storage state
        function showStorageState() {
            const users = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('emailUser_') || key.startsWith('evidUser_')) {
                    users.push(key);
                }
            }
            
            if (users.length > 0) {
                console.log('Stored users:', users);
            } else {
                console.log('No users found in storage');
            }
        }
        
        // Initialize
        showStorageState();
    </script>
</body>
</html>